<!DOCTYPE html>
<html lang="de">
<head>
    <!-- Metadaten und Styles unverändert -->
    <style>
        /* Neuen CSS für Datei-Anzeige hinzufügen */
        .file-info {
            margin-top: 1rem;
            display: none;
            align-items: center;
            justify-content: space-between;
            background: rgba(108,92,231,0.1);
            padding: 1rem;
            border-radius: 0.5rem;
        }

        .file-info.active {
            display: flex;
        }

        .file-info span {
            max-width: 70%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .remove-file {
            background: var(--danger);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .remove-file:hover {
            background: #ff6b81;
        }

        /* Upload-Sektion anpassen */
        .upload-section button {
            margin: 0 auto;
        }

        .upload-instructions {
            margin-top: 1rem;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header unverändert -->
        
        <div class="main-card">
            <div class="upload-section" id="dropZone">
                <input type="file" id="fileInput" accept="audio/*">
                
                <!-- Neuer Datei-Info-Bereich -->
                <div class="file-info" id="fileInfo">
                    <span id="fileName"></span>
                    <div class="remove-file" onclick="removeAudio()">
                        <i class="fas fa-times-circle"></i> Entfernen
                    </div>
                </div>

                <!-- Ursprünglicher Upload-Button -->
                <button id="uploadButton" onclick="document.getElementById('fileInput').click()">
                    <i class="fas fa-upload"></i> Audio hochladen
                </button>
                <p class="upload-instructions">oder Datei hierher ziehen</p>
            </div>

            <!-- Restliche Elemente unverändert -->
        </div>
    </div>

    <script>
        // Neuer Code für Dateiverwaltung
        function updateFileInfo(name) {
            document.getElementById('fileName').textContent = name;
            document.getElementById('fileInfo').classList.add('active');
            document.getElementById('uploadButton').style.display = 'none';
            document.querySelector('.upload-instructions').style.display = 'none';
        }

        function removeAudio() {
            // Zurücksetzen aller Komponenten
            document.getElementById('fileInput').value = '';
            document.getElementById('fileInfo').classList.remove('active');
            document.getElementById('uploadButton').style.display = 'flex';
            document.querySelector('.upload-instructions').style.display = 'block';
            
            if (wavesurfer) {
                wavesurfer.empty();
                wavesurfer.destroy();
                initWaveSurfer();
            }
            
            audioBuffer = null;
            resetUI();
        }

        // Wellenform neu initialisieren
        function initWaveSurfer() {
            wavesurfer = WaveSurfer.create({
                container: '#waveform',
                waveColor: '#6c5ce7',
                progressColor: '#4b4bff',
                height: 150,
                responsive: true,
                normalize: true,
                cursorColor: '#ffffff'
            });
        }

        // Angepasste Datei-Handling-Funktion
        async function handleFileUpload(e) {
            const file = e.target.files[0];
            if (!file) return;

            updateFileInfo(file.name);
            
            try {
                const audioContext = new AudioContext();
                const arrayBuffer = await file.arrayBuffer();
                audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
                
                if (wavesurfer) {
                    wavesurfer.load(URL.createObjectURL(file));
                }
            } catch (error) {
                alert(`Fehler beim Laden der Datei: ${error.message}`);
                removeAudio();
            }
        }

        // Restlicher JavaScript-Code unverändert
    </script>
</body>
</html>
